{% extends 'parent/base.html' %}

{% block title %} Payments | AbrayTech {% endblock %}

{% load static %}

{% block content %}
<!-- Breadcrumbs Section -->
<section class="breadcrumbs-section py-5 bg-light" style="margin-top: 80px; padding-top: 20px;">
    <div class="container">
        <nav style="--bs-breadcrumb-divider: 'â€º';" aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Payments</li>
            </ol>
        </nav>
    </div>
</section><!-- End Breadcrumbs -->

<section id="payments" class="payments section">
    <div class="container" data-aos="fade-up">

        <div class="section-title">
            <h2>Payments</h2>
            <p>Manage fee balances, make payments, and view receipts.</p>
        </div>

        <!-- Fee Balances Section -->
        <div class="fee-balances">
            <h4>Fee Balances</h4>
            <p>Outstanding fee balance: <strong>${{ balance.amount }}</strong></p>
            <p>Due Date: <strong>{{ balance.due_date|date:"M d, Y" }}</strong></p>
        </div>

        <!-- Payment Options -->
        <div class="payment-options">
            <h4>Make a Payment</h4>
            <form method="post" action="{ url 'make_payment' %}" class="payment-form">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-6">
                        <label for="amount" class="pb-2">Amount</label>
                        <input type="number" class="form-control" name="amount" id="amount" required placeholder="Enter amount to pay">
                    </div>
                    <div class="col-md-6">
                        <label for="payment-method" class="pb-2">Payment Method</label>
                        <select class="form-control" name="payment_method" id="payment-method" required>
                            <option value="credit_card">Credit Card</option>
                            <option value="bank_transfer">Bank Transfer</option>
                            <option value="paypal">PayPal</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-12 text-center pt-4">
                    <button type="submit" class="w-100 bg-primary">Proceed to Payment</button>
                </div>
            </form>
        </div>

        <!-- Payment History -->
        <div class="payment-history mt-4">
            <h4>Payment History</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Payment Method</th>
                        <th>Status</th>
                        <th>Receipt</th>
                    </tr>
                </thead>
                <tbody>
                    {% for payment in payment_history %}
                    <tr>
                        <td>{{ payment.date|date:"M d, Y" }}</td>
                        <td>${{ payment.amount }}</td>
                        <td>{{ payment.method }}</td>
                        <td>{{ payment.status }}</td>
                        <td>
                            <a href="{ url 'view_receipt' payment.id %}" class="btn btn-secondary">View Receipt</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5">No payment history available.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

    </div>
</section>
{% endblock %}
